功能符测试：



模糊搜索:

"key$":"SQL搜索表达式" => "key$":["SQL搜索表达式"]，任意SQL搜索表达式字符串，如 %key%(包含key), key%(以key开始), %k%e%y%(包含字母k,e,y) 等，%表示任意字符



```
{
    "[]": {
        "count": 20,
        "Moment": {
            "@column": "id,userId,content",
            "content$":"%APIJSON%"
         //   "@group": "userId"
        }
    }
}             

```

```
SELECT id,userId,content FROM test.Moment WHERE  (  (content LIKE '%APIJSON%')  )  LIMIT 20
```

测试结果： 成功



### 存在函数测试

```
{    
    "User": {
        "id}{@": {
            "from": "Comment",
            "Comment": {
                "momentId": 15
            }
        }
    }
}

生成sql：SELECT * FROM `test`.`apijson_user` WHERE  (  ( EXISTS (SELECT * FROM `test`.`Comment` WHERE  (  (`momentId` = 15)  ) ) )  )  LIMIT 1

修改为如下后执行正确

SELECT * FROM `test`.`apijson_user` WHERE  15 in (  (SELECT `momentId` FROM `test`.`Comment`  ) )   LIMIT 1


```

执行错误：

```
cc.blynk.clickhouse.except.ClickHouseException: ClickHouse exception, code: 62, host: null, port: 0; Code: 62, e.displayText() = DB::Exception: Syntax error: failed at position 71 ('`test`'): `test`.`Comment` WHERE  (  (`momentId` = 15)  ) ) )  )  LIMIT 1 FORMAT TabSeparatedWithNamesAndTypes
. Expected one of: DoubleColon, LIKE, GLOBAL NOT IN, AS, DIV, IS, UUID, OR, QuestionMark, BETWEEN, NOT LIKE, MOD, AND, Comma, alias, IN, ILIKE, Dot, NOT ILIKE, NOT, token, NOT IN, GLOBAL IN (version 21.7.5.29 (official build))

```





raw关键字

```
{
    "Comment": {
        "@column": "cast(now() as date)",
        "@raw": "@column"
    }
}
    
```



### **explain关键字**



clickhosue 不支持 explain关键字



测试having

```
{
    "[]": {
        "Comment": {
            "@column": "date;left(date,10):day;sum(if(userId%2=0,1,0))",
            "@group": "day",
            "@having": "to_days(now())-to_days(`date`)<=7",
            "@raw": "@column,@having"
        }
    }
}
                                                                                                                                                                                                              
```

函数嵌套：

@column ： 

day(now())



全文检索：



select count(*)  from Fans   f  where exists(select 1) from Fans  d  where  f.id=d.fid and f.fid = d.id )

select count(*) from Fans  where(i)



select count(MANDAY)  from  ET where ENO = (select     eno  from  E where ENAME = "王明")